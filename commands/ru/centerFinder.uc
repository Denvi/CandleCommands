[
    {
        "hint": "Центр отверстия",
        "imageName": "*hole.png",
        "imageBase64": "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtGVYSWZJSSoACAAAAAYAEgEDAAEAAAABAAAAGgEFAAEAAABWAAAAGwEFAAEAAABeAAAAKAEDAAEAAAACAAAAEwIDAAEAAAABAAAAaYcEAAEAAABmAAAAAAAAAEgAAAABAAAASAAAAAEAAAAGAACQBwAEAAAAMDIxMAGRBwAEAAAAAQIDAACgBwAEAAAAMDEwMAGgAwABAAAA//8AAAKgBAABAAAAQAAAAAOgBAABAAAAQAAAAAAAAABuEYT5AAACeElEQVR4nO2aO28UMRCAP6yrkwrxEIFACxyU/ARoEEEKgkBDEwh0/AsixI8AQgoqhHg0UKcNjx4JchdK0nBJkUWWfBJa2Wfv2tzasT/J0mlkr+2xPZ4ZHxQKhUKhUCjYuQisA9tA1aD40qSvIfAS6BOY28Bew8F0oYBx2QWWCLjyey0H0pUCxkoIshPWPQbRpQJkWQvQP78SVoC0CRPpOQzgsEb2FNhgOtxwrHcJeFSTHQkxgEpTFomPxTY7UJA5gswRZI4gcwSZI8icXgd9zgJXgLPACSX7CXwFPgC/iYwqkB9wWrmmuxb//TkwPy0/YFoKeGCZeL2MgHuxKMCXJx6+/CqJ89AzmJFlhUQ5Y9n2A+At8E5FbZOOQxub0DlrhglJi38VOFS7jq8BW4Y20jAmxaxh9eXk5ya0mzMoQX5rhoS4aVhJufI2FgxtXfMCUXiC5zQyeebfOLR9rTLPdc6TkAKOa2Sbjvfyvqrr8s1oFVBpZP8aPRu6ulVKChhqZBcc+xOGdLY1wRmTAr5oZMcaGMGjGvlnEmLGcA1uWa7Bk8pY6pyhpK5BlPNSGZSwUNt98vd1w+RleUaCzKuVM7m48ky/V2XSg+sf4BSJcjdAMNQ0LI6OVY/JPyYCqgAJkfuW46Db9ssHKSM0tgkvLCHySBm8Nme+lQJ6TI/vwB2VHrus4oVxUvQH8E0lRXeIjCrQDvjflMfRNggyR5A5gswRZI4gc3oOdSpNhkb+IcmVV/jheuXqxhTEE9z2DGZ88el7GOIIfCJdPob4SL/hy24sO2BkSM+3YslDCb60nfwtAtNX732DiBUwUBFnsJUvFAqFQqHAgeUvajYzJ0z7F7sAAAAASUVORK5CYII=",
        "type": "1",
        "code": "const feedRate = 50;\n\nscript.importExtension(\"qt.core\");\nscript.importExtension(\"qt.widgets\");\n\n(function () {\n    const settings = app.storage.group(\"HoleCenterFinder\");\n    const storedRadius = settings.value(\"radius\", 10);\n\n    const radius = QInputDialog.getDouble(\n        app.window,\n        \"Поиск центра отверстия\",\n        \"Радиус поиска\",\n        storedRadius, 0.0, 100.0, 0,\n        Qt.Dialog\n    );\n    if (!radius) return;\n\n    settings.setValue(\"radius\", radius);\n\n    const startX = app.device.work.x;\n    const startY = app.device.work.y;\n\n    // Search for X center\n    app.device.sendCommand(\"G91 G38.2 F\" + feedRate + \" X\" + radius);\n    app.device.waitResponses();\n\n    const probeX = app.device.probe.x;\n\n    app.device.sendCommands([\n        \"G90 G0 X\" + startX,\n        \"G91 G38.2 X-\" + radius\n    ]);\n    app.device.waitResponses();\n    app.device.sendCommand(\"G90 G53 G0 X\" + (app.device.probe.x + probeX) / 2);\n\n    // Search for Y center\n    app.device.sendCommand(\"G91 G38.2 Y\" + radius);\n    app.device.waitResponses();\n\n    const probeY = app.device.probe.y;\n\n    app.device.sendCommands([\n        \"G90 G0 Y\" + startY,\n        \"G91 G38.2 Y-\" + radius\n    ]);\n    app.device.waitResponses();\n    app.device.sendCommand(\"G90 G53 G0 Y\" + (app.device.probe.y + probeY) / 2);\n})();"
    },
    {
        "hint": "Центр выступа",
        "imageName": "*boss.png",
        "imageBase64": "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtGVYSWZJSSoACAAAAAYAEgEDAAEAAAABAAAAGgEFAAEAAABWAAAAGwEFAAEAAABeAAAAKAEDAAEAAAACAAAAEwIDAAEAAAABAAAAaYcEAAEAAABmAAAAAAAAAEgAAAABAAAASAAAAAEAAAAGAACQBwAEAAAAMDIxMAGRBwAEAAAAAQIDAACgBwAEAAAAMDEwMAGgAwABAAAA//8AAAKgBAABAAAAQAAAAAOgBAABAAAAQAAAAAAAAABuEYT5AAACEElEQVR4nO2au0oEMRSGP8NqqTYiiqBiqS6WPoG4D7CCl8bGa+dbKOJDeIX1BWy0tld7wXupjavNSCALIotzyZndySYfnCYMJ8k/J8nJmYFAIBAIBAKBeGaAM+AViFKYLWn6egFOgTLCLAPfKQfTDgEa9gUsIfjmvzMOpF0CNEQQiYQzi0G0UwBtJwL98+awAHpP+JdSggEMNGk7AK5pDQsJn5sFdv60DUoMIGpiVYpHNUsEKjxH4TkKz1F4jsJzFJ5TakOffUAFmARGTNsjcAtcAO8UjEgoDxg3qelXTP5+BIy1Kg9olQBbMRP/a3VgvSgC2LJvkcvv4TjblpcZbZs4yrgJZVsB9NKZwEFOBCbfML0xOkVfyk0vznRFqt+lRKgC9Aj66wbmcEiAaUd8kpcAQzn4HHZJgMgRn+QlQGwxMgNPLglwk4NPfVlyhl7hY7BufDoTAR9ATdBfzfh0ijGhVPgTGMVRVgUESHstLhx7FpPfpQBEAgWRjZTLQYf9WidVhBp7wnHM6aBFOsy45jMJUKJ13AMrpjw2D0z9Koo+AHemKFq43T4SioC8CR9Hs6DwHIXnKDxH4TkKzykleEYfJV1NfkhKyjl2JD1ym41JJBN8tbzM2GLT94vEErjCXS4lnJQtqzu2ZO23btJtEZYsRLAl6+QXEaZsvvc9F1iAZ3PjFHvzgUAgEAgE6Fh+AM5ZLQL0nQ2MAAAAAElFTkSuQmCC",
        "type": "1",
        "code": "const feedRate = 50;\n\nscript.importExtension(\"qt.core\");\nscript.importExtension(\"qt.widgets\");\n\n(function () {\n    const settings = app.storage.group(\"BossCenterFinder\");\n    const storedRadius = settings.value(\"radius\", 10);\n    const storedDepth = settings.value(\"depth\", 10);\n\n    const dialog = createDialog(storedRadius, storedDepth);\n    if (!dialog.exec())\n        return;\n\n    const radius = dialog.radius();\n    const depth = dialog.depth();\n\n    settings.setValue(\"radius\", radius);\n    settings.setValue(\"depth\", depth);\n\n    const startX = app.device.work.x;\n    const startY = app.device.work.y;\n\n    // Search for X center\n    app.device.sendCommands([\n        \"G91 G0 X\" + radius,\n        \"G91 G1 Z-\" + depth + \" F\" + feedRate,\n        \"G91 G38.2 X-\" + radius\n    ]);\n    app.device.waitResponses();\n\n    const probeX = app.device.probe.x;\n\n    app.device.sendCommands([\n        \"G91 G0 X1\",\n        \"G91 G0 Z\" + depth,\n        \"G90 G0 X\" + startX,\n        \"G91 G0 X-\" + radius,\n        \"G91 G1 Z-\" + depth,\n        \"G91 G38.2 X\" + radius\n    ]);\n    app.device.waitResponses();\n\n    app.device.sendCommands([\n        \"G91 G0 X-1\",\n        \"G91 G0 Z\" + depth,\n        \"G90 G53 G0 X\" + (app.device.probe.x + probeX) / 2\n    ]);\n\n    // Search for Y center\n    app.device.sendCommands([\n        \"G91 G0 Y\" + radius,\n        \"G91 G1 Z-\" + depth + \" F\" + feedRate,\n        \"G91 G38.2 Y-\" + radius\n    ]);\n    app.device.waitResponses();\n\n    const probeY = app.device.probe.y;\n\n    app.device.sendCommands([\n        \"G91 G0 Y1\",\n        \"G91 G0 Z\" + depth,\n        \"G90 G0 Y\" + startY,\n        \"G91 G0 Y-\" + radius,\n        \"G91 G1 Z-\" + depth,\n        \"G91 G38.2 Y\" + radius\n    ]);\n    app.device.waitResponses();\n\n    app.device.sendCommands([\n        \"G91 G0 Y-1\",\n        \"G91 G0 Z\" + depth,\n        \"G90 G53 G0 Y\" + (app.device.probe.y + probeY) / 2\n    ]);\n})();\n\nfunction createDialog(storedRadius, storedDepth)\n{\n    const dialog = new QDialog(app.window);\n    const layoutMain = new QVBoxLayout(dialog);\n    const layoutParams = new QGridLayout();\n    const lblRadius = new QLabel(\"Радиус поиска:\", dialog);\n    const lblDepth = new QLabel(\"Глубина:\", dialog);\n    const sbpRadius = new QSpinBox(dialog);\n    const sbpDepth = new QSpinBox(dialog);\n    const buttons = new QDialogButtonBox(QDialogButtonBox.StandardButtons(QDialogButtonBox.Ok, QDialogButtonBox.Cancel), dialog);\n\n    layoutParams.addWidget(lblRadius, 0, 0);\n    layoutParams.addWidget(lblDepth, 1, 0);\n    layoutParams.addWidget(sbpRadius, 0, 1);\n    layoutParams.addWidget(sbpDepth, 1, 1);\n\n    layoutMain.addLayout(layoutParams);\n    layoutMain.addWidget(buttons, 0, 0);\n\n    sbpRadius.minimum= 0;\n    sbpRadius.maximum = 1000;\n    sbpRadius.value = storedRadius;\n    sbpDepth.minimum= 0;\n    sbpDepth.maximum = 1000;\n    sbpDepth.value = storedDepth;\n\n    buttons.accepted.connect(dialog.accept);\n    buttons.rejected.connect(dialog.reject);\n\n    dialog.radius = function() { return sbpRadius.value };\n    dialog.depth = function() { return sbpDepth.value };\n\n    dialog.setWindowTitle(\"Поиск центра выступа\");\n    dialog.setFixedSize(dialog.sizeHint);\n\n    return dialog;\n}"
    }
]